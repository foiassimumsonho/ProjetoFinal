<header class="header">
  <div class="header-left">
    <button class="menu-btn" (click)="toggleMenu()">☰</button>
    <div class="logo">
      <img src="assets/img/32 CM.png" alt="Logo Arte Baiana">
    </div>
  </div>
</header>

<nav class="sidebar" [class.open]="menuOpen">
  <ul>
    <li><a routerLink="/" routerLinkActive="active">Home</a></li>
    <li><a routerLink="/sobre" routerLinkActive="active">Sobre nós</a></li>
    <li><a routerLink="/fale" routerLinkActive="active">Fale conosco</a></li>
  </ul>
</nav>

<div class="cadastro-container">
  <div class="cadastro-box">
    <h2>Cadastro</h2>

    <form (ngSubmit)="cadastrar()" #cadastroForm="ngForm">

      <div class="form-grid">

        <div class="form-item">
          <label for="nome">Nome</label>
          <input id="nome" name="nome" [(ngModel)]="usuario.nome" required #nomeRef="ngModel" />
          <div *ngIf="nomeRef.invalid && (nomeRef.dirty || nomeRef.touched)" class="error-msg">
            Nome é obrigatório.
          </div>
        </div>

        <div class="form-item">
          <label for="senha">Senha</label>
          <input id="senha" name="senha" type="password" [(ngModel)]="usuario.senha" required minlength="6" #senhaRef="ngModel" />
          <div *ngIf="senhaRef.invalid && (senhaRef.dirty || senhaRef.touched)" class="error-msg">
            Senha deve ter no mínimo 6 caracteres.
          </div>
        </div>

        <div class="form-item">
          <label for="email">Email</label>
          <input 
            id="email" 
            name="email" 
            type="email" 
            [(ngModel)]="usuario.email" 
            required 
            email 
            maxlength="100"
            pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
            #emailRef="ngModel" 
          />
          <div *ngIf="emailRef.invalid && (emailRef.dirty || emailRef.touched)" class="error-msg">
            <span *ngIf="emailRef.errors?.['required']">Email é obrigatório.</span>
            <span *ngIf="emailRef.errors?.['email'] || emailRef.errors?.['pattern']">Digite um email válido (ex: nome&#64;email.com).</span>          </div>
        </div>

        <div class="form-item">
          <label for="telefone">Telefone (com DDD)</label>
          <input 
            id="telefone" 
            name="telefone" 
            type="tel" 
            [(ngModel)]="usuario.telefone" 
            required 
            maxlength="15"
            minlength="10"
            placeholder="(XX) 9XXXX-XXXX"
            (keypress)="apenasNumeros($event)"
            #telRef="ngModel"
          />
          <div *ngIf="telRef.invalid && (telRef.dirty || telRef.touched)" class="error-msg">
            <span *ngIf="telRef.errors?.['required']">Telefone é obrigatório.</span>
            <span *ngIf="telRef.errors?.['minlength']">Digite o DDD + Número completo.</span>
          </div>
        </div>

<div class="form-item">
          <label for="estado">Estado</label>
          <select 
            id="estado" 
            name="estado" 
            [(ngModel)]="usuario.estado" 
            (change)="aoMudarEstado()" 
            required 
            #estRef="ngModel"
            [class.invalid]="estRef.invalid && estRef.touched">
            
            <option value="" disabled selected>Selecione um estado</option>
            
            <option *ngFor="let est of listaEstados" [value]="est.sigla">
              {{ est.nome }}
            </option>
          </select>
        </div>

        <div class="form-item">
          <label for="municipio">Município</label>
          
          <select 
            id="municipio" 
            name="municipio" 
            [(ngModel)]="usuario.municipio" 
            required 
            [disabled]="!usuario.estado || carregandoCidades"
            #munRef="ngModel"
            [class.invalid]="munRef.invalid && munRef.touched">
            
            <option value="" disabled selected>
              {{ carregandoCidades ? 'Carregando cidades...' : 'Selecione a cidade' }}
            </option>
            
            <option *ngFor="let cidade of listaMunicipios" [value]="cidade.nome">
              {{ cidade.nome }}
            </option>
          </select>
        </div>     
      </div>

      <div class="lgpd-box">
        <label>
          <input type="checkbox" [(ngModel)]="aceitaLgpd" name="lgpd" required />
          Declaro que li e aceito a Política de Privacidade e autorizo o uso dos meus dados conforme a LGPD.
        </label>
        <a href="https://www.gov.br/governodigital/pt-br/privacidade-e-seguranca/ppsi/modelo_ppdp.pdf" class="lgpd-link"> Ler Política de Privacidade </a>
      </div>

      <button type="submit" [disabled]="!cadastroForm.form.valid || !aceitaLgpd">
        Cadastrar
      </button>

    </form>

  </div>
</div>

<footer class="footer">
  <div class="footer-left">
    <div class="social-icons">
      <a href="https://facebook.com" target="_blank"><img src="assets/img/facebook.png"></a>
      <a href="https://instagram.com" target="_blank"><img src="assets/img/instagram.png"></a>
      <a href="https://twitter.com" target="_blank"><img src="assets/img/twitter.png"></a>
    </div>
  </div>
  <div class="footer-center">
    <p>© Copyright 2025. Arte Baiana. Direitos reservados.</p>
  </div>
  <div class="footer-right">
    <div class="footer-links">
      <a href="https://portaldatransparencia.gov.br/termos-de-uso">Termos de uso</a>
    </div>
  </div>
</footer>